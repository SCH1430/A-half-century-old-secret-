<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
        <meta name="theme-color" content="#0b0d19">
    <meta name="description" content="–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –æ –ì.–í. –ö–∏—Å—É–Ω—å–∫–æ: –∫–≤–µ—Å—Ç, ¬´–ü–æ–ª–∏–≥–æ–Ω –∏—Å–ø—ã—Ç–∞–Ω–∏–π¬ª –∏ –≥–∞–ª–µ—Ä–µ—è.">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="manifest" href="manifest.webmanifest">
    <link rel="apple-touch-icon" href="icons/icon-192.png">
<title>–ü—Ä–æ–µ–∫—Ç 1430 - –ì.–í. –ö–∏—Å—É–Ω—å–∫–æ</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen">
        <div class="project-logo">
            <div class="radar-icon"></div>
        </div>
        <div class="title-typewriter" id="titleTypewriter"></div>
        <div class="subtitle-loading">
            <span class="loading-dots">–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–≥–æ –∞—Ä—Ö–∏–≤–∞</span>
        </div>
        <div class="menu-buttons" id="menuButtons">
            <div class="menu-group" id="questMenuGroup">
                <button class="menu-btn" type="button" id="questMainBtn" onclick="continueQuest()">–¢–ï–ö–°–¢–û–í–´–ô –ö–í–ï–°–¢</button>
                <div class="menu-note hidden" id="questProgressNote" aria-live="polite"></div>
                <button class="menu-btn menu-btn-secondary hidden" type="button" id="questRestartBtn" onclick="restartQuest()">–ù–ê–ß–ê–¢–¨ –ó–ê–ù–û–í–û</button>
            </div>
            <!-- –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ–º —Ä–µ–∂–∏–º Tower Defense –≤ "–ü–æ–ª–∏–≥–æ–Ω –ò—Å–ø—ã—Ç–∞–Ω–∏–π" -->
            <button class="menu-btn" type="button" onclick="startDefense()">–ü–û–õ–ò–ì–û–ù –ò–°–ü–´–¢–ê–ù–ò–ô</button>
            <button class="menu-btn" type="button" onclick="startGallery()">–ì–ê–õ–ï–†–ï–Ø</button>
        </div>
        <div class="menu-footer" id="menuFooter">
            –ê–≤—Ç–æ—Ä—ã: –ú–∞—Ä—ã–∫–∏–Ω –¢–∏–º–æ—Ñ–µ–π –∏ –ú–∞–∫—Å–∏–º –¢—Ä—É—à–∏–Ω ‚Ä¢ –ü—Ä–æ–µ–∫—Ç 1430
            <span class="menu-consultant">–ö–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç: –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –º—É–∑–µ—è –∏—Å—Ç–æ—Ä–∏–∏ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ—Ç–∏–≤–æ—Ä–∞–∫–µ—Ç–Ω–æ–π –æ–±–æ—Ä–æ–Ω—ã ¬´–ó–≤–µ–∑–¥—ã –≤ –ø—É—Å—Ç—ã–Ω–µ¬ª –ì–ë–û–£ –≥. –ú–æ—Å–∫–≤—ã ¬´–®–∫–æ–ª–∞ ‚Ññ 1430¬ª, –î–∞–≤–∏–¥–æ–≤–∏—á –ê–Ω–Ω–∞ –ü–∞–≤–ª–æ–≤–Ω–∞.</span>
        </div>
    </div>

    <!-- Main Application -->
    <div id="app">
        <button class="back-btn" type="button" onclick="returnToMenu()">‚Üê –ú–ï–ù–Æ</button>
        
        <!-- Quest Mode -->
        <div id="questMode" class="hidden">
            <div class="quest-container" id="questContainer"></div>
        </div>

        <!-- Tower Defense Mode -->
        <div id="defenseMode" class="hidden">
            <div class="defense-container">
                <div class="game-header">
                    <!-- –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Ä–µ–∂–∏–º–∞ –æ–±–æ—Ä–æ–Ω—ã –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –Ω–æ–≤—ã–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º -->
                    <h2 class="mode-title">–ü–û–õ–ò–ì–û–ù –ò–°–ü–´–¢–ê–ù–ò–ô</h2>

                    <div class="stats" aria-label="–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª–∏–≥–æ–Ω–∞">
                        <div class="stat-item">
                            <span class="stat-label">–ó–¥–æ—Ä–æ–≤—å–µ:</span>
                            <span class="stat-value" id="health">100</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">–†–µ—Å—É—Ä—Å—ã:</span>
                            <span class="stat-value" id="resources">1000</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">–í–æ–ª–Ω–∞:</span>
                            <span class="stat-value" id="wave">1</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">–û—Å—Ç–∞–ª–æ—Å—å:</span>
                            <span class="stat-value" id="enemiesLeft">0</span>
                        </div>
                    </div>

                    <div class="defense-controls" aria-label="–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª–∏–≥–æ–Ω–æ–º">
                        <button class="defense-btn" type="button" id="pauseBtn" aria-pressed="false" title="–ü–∞—É–∑–∞ (P)">‚è∏</button>
                        <button class="defense-btn" type="button" id="speedBtn" aria-pressed="false" title="–°–∫–æ—Ä–æ—Å—Ç—å (X)">‚è© x1</button>
                    </div>
                </div>

                <!-- –£–¥–∞–ª—è–µ–º –∞—Ç—Ä–∏–±—É—Ç—ã width/height, —á—Ç–æ–±—ã —Ä–∞–∑–º–µ—Ä—ã –∑–∞–¥–∞–≤–∞–ª–∏—Å—å –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ —á–µ—Ä–µ–∑ CSS –¥–ª—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏ -->
                <canvas id="gameCanvas" class="game-canvas"></canvas>

                <div class="tower-actions hidden" id="towerActions" aria-hidden="true"></div>

                <!-- Mobile bottom sheet: Towers / Fact tabs (no overlapping panels on phones) -->
                <div class="defense-sheet" id="defenseSheet" aria-label="–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª–∏–≥–æ–Ω–æ–º">
                    <div class="defense-sheet-handle" id="defenseSheetHandle" role="button" tabindex="0" aria-label="–ò–∑–º–µ–Ω–∏—Ç—å –≤—ã—Å–æ—Ç—É –ø–∞–Ω–µ–ª–∏"></div>
                    <div class="defense-sheet-tabs" role="tablist" aria-label="–ü–∞–Ω–µ–ª—å: –ë–∞—à–Ω–∏ –∏ –§–∞–∫—Ç">
                        <button class="defense-sheet-tab is-active" type="button" id="sheetTabTowers" role="tab"
                            aria-selected="true" aria-controls="sheetPanelTowers">–ë–∞—à–Ω–∏</button>
                        <button class="defense-sheet-tab" type="button" id="sheetTabFact" role="tab"
                            aria-selected="false" aria-controls="sheetPanelFact">–§–∞–∫—Ç</button>
                    </div>

                    <div class="defense-sheet-body">
                        <div class="defense-sheet-panel is-active" id="sheetPanelTowers" role="tabpanel" aria-labelledby="sheetTabTowers">
                            <div class="tower-panel" id="towerPanel"></div>
                        </div>

                        <div class="defense-sheet-panel" id="sheetPanelFact" role="tabpanel" aria-labelledby="sheetTabFact">
                            <div id="historicalFact" class="historical-fact hidden">
                    <div class="wave-summary" id="waveSummary" aria-live="polite"></div>
                    <div class="fact-title" id="factTitle"></div>
                    <div class="fact-content">
                        <div class="fact-text fact-collapsed" id="factContent"></div>
                        <button class="fact-toggle" id="factToggle" type="button" aria-expanded="false">–ß–∏—Ç–∞—Ç—å –¥–∞–ª–µ–µ</button>
                    </div>
                    <button class="menu-btn next-wave-btn" type="button" onclick="nextWave()">–°–õ–ï–î–£–Æ–©–ê–Ø –í–û–õ–ù–ê</button>
                            </div>
                            <div class="fact-placeholder" id="factPlaceholder" aria-live="polite">
                                üìå –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π —Ñ–∞–∫—Ç –ø–æ—è–≤–∏—Ç—Å—è –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤–æ–ª–Ω—ã.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Gallery Mode -->
        <div id="galleryMode" class="hidden">
            <div class="gallery-container" id="galleryContainer"></div>
        </div>
    </div>

    <!-- Sound Controls (collapsed by default; expands on click) -->
    <div class="sound-controls" id="soundControls">
        <button class="install-btn hidden" id="installBtn" type="button" aria-label="–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ" title="–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å">‚¨áÔ∏è</button>
        <button class="help-btn" id="helpBtn" type="button" aria-label="–°–ø—Ä–∞–≤–∫–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ">
                <svg class="ui-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                    <circle cx="12" cy="12" r="9" fill="none" stroke="currentColor" stroke-width="2"></circle>
                    <path d="M9.5 9.5a2.5 2.5 0 1 1 4.5 1.5c-.6.6-1.5 1-2.2 1.5-.7.5-.8 1-.8 2" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                    <circle cx="12" cy="17.5" r="1" fill="currentColor"></circle>
                </svg>
            </button>
        <button class="sound-panel-toggle" id="soundPanelToggle" type="button" aria-label="–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–≤—É–∫–∞">
                <svg class="ui-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                    <path d="M4 10v4h4l5 4V6L8 10H4z" fill="none" stroke="currentColor" stroke-width="2" stroke-linejoin="round"></path>
                    <path class="wave" d="M16.5 9.5a4 4 0 0 1 0 5" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"></path>
                    <path class="wave" d="M19 7a7 7 0 0 1 0 10" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"></path>
                    <path class="mute-slash" d="M3.5 3.5L20.5 20.5" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"></path>
                </svg>
            </button>
        <div class="sound-panel-body" id="soundPanelBody" aria-hidden="true">
            <button class="sound-toggle" type="button" onclick="toggleSound()" id="soundBtn" aria-pressed="false">üîá –ó–í–£–ö: –í–´–ö–õ</button>
            <div class="volume-control">
                <label for="volumeSlider">–ì—Ä–æ–º–∫–æ—Å—Ç—å:</label>
                <input id="volumeSlider" type="range" class="volume-slider" min="0" max="100" value="50" oninput="changeVolume(this.value)">
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>